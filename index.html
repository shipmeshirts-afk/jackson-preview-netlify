<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Design Prompt Previewer</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 text-gray-900 p-6">
  <div class="max-w-4xl mx-auto space-y-6">
    <h1 class="text-3xl font-bold">Design Prompt Previewer</h1>

    <label class="flex items-center space-x-2">
      <input id="demoMode" type="checkbox" class="h-4 w-4" />
      <span>Demo mode (no backend)</span>
    </label>

    <textarea id="prompt" class="w-full p-3 rounded border" rows="3"
      placeholder="Enter design prompt..."></textarea>

    <div class="grid grid-cols-3 gap-3">
      <select id="style" class="p-3 border rounded">
        <option>Clean vector logo</option>
        <option>Bold mascot logo</option>
        <option>Realistic patch engraving</option>
      </select>

      <select id="size" class="p-3 border rounded">
        <option>1024x1024</option>
        <option>512x512</option>
        <option>2048x2048</option>
      </select>

      <input id="seed" class="p-3 border rounded" placeholder="Seed (optional)" />
    </div>

    <button id="generateBtn"
      class="px-6 py-3 bg-black text-white rounded hover:bg-gray-800">
      Generate
    </button>

    <div class="border bg-white rounded h-[500px] flex items-center justify-center">
      <img id="preview" src="" class="max-h-full max-w-full" alt="Preview" />
    </div>

    <p class="text-xs text-gray-500 text-center">
      Previews are for concepting only. Final production artwork will be prepared by Jackson Signs & T-Shirts.
    </p>
  </div>

<script>
document.getElementById("generateBtn").addEventListener("click", async () => {
  const demoMode = document.getElementById("demoMode").checked;
  const prompt = document.getElementById("prompt").value;
  const style = document.getElementById("style").value;
  const size = document.getElementById("size").value;

  const preview = document.getElementById("preview");
  preview.src = "";

  if (!prompt) return alert("Enter a prompt first");

  if (demoMode) {
    preview.src = `https://source.unsplash.com/${size}/?${encodeURIComponent(prompt)}`;
    return;
  }

  const response = await fetch(`/.netlify/functions/generate?prompt=${encodeURIComponent(prompt)}&style=${encodeURIComponent(style)}&size=${size}`);
  const data = await response.json();
  preview.src = data.url || data.fallback;
});
</script>

</body>
</html>
